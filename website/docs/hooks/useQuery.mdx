---
sidebar_position: 2
sidebar_label: useQuery()
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# useQuery(...)

The Hook enables you to perform asynchronous data fetching operations.
It automatically handles loading states, caching, and data invalidation,
significantly simplifying request in React.
See the TanStack [_useQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQuery)
documentation for more details.

```ts
const query = api.<service>.<operation>.useQuery(
  parameters,
  queryOptions
)
```

### Returns

`UseQueryResult` object, see the TanStack [_UseQueryResult ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQuery#:~:text=will%20be%20used.-,Returns,-status%3A%20String)

### Arguments

1.  `parameters: { path, query, header } | QueryKey | void`
    - **Required only if OpenAPI specification defines required parameters**
    - If the operation has no required parameters according to OpenAPI, you can omit this argument
    - `parameters` will be used to generate the `QueryKey`
    - Instead of an object with `{ path, query, header }`, you can pass a `QueryKey` as an array
      which is also strictly-typed

2.  `queryOptions?: UseQueryOptions`
    - **Optional**, represents the options of the [_useQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQuery) Hook
      - `queryOptions.queryFn` could be provided to override the default `queryFn` used by Qraft

### Example

<Tabs>
  <TabItem value="parameters" label={<span style={{verticalAlign: 'middle'}}>by <code>parameters</code></span>} default>
    ```tsx title="src/ApprovalPolicyName.tsx"
    import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

    import { requestFn } from '@openapi-qraft/react';
    import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

    const queryClient = new QueryClient();

    const api = createAPIClient({
      requestFn,
      queryClient,
      baseUrl: 'https://api.sandbox.monite.com/v1',
    });

    function ApprovalPolicyName() {
      /**
       * `<service>.<operation>.useQuery(...)` initiates the request to retrieve data:
       * ###
       * GET /approval_policies/321?items_order=asc&items_order=desc
       * x-monite-version: 1.0.0
       */
      const { data, error, isPending } =
        api.approvalPolicies.getApprovalPoliciesId.useQuery(
          {
            header: {
              "x-monite-version": "1.0.0",
            },
            path: {
              approval_policy_id: "123",
            },
            query: {
              items_order: ["asc", "desc"],
            },
          },
        );

      if (isPending) {
        return <div>Loading...</div>;
      }

      if (error) {
        return <div>Error: {error.message}</div>;
      }

      return <div>Approval Policy: {data?.name}</div>;
    }

    export default function App() {
      return (
        <QueryClientProvider client={queryClient}>
          <ApprovalPolicyName />
        </QueryClientProvider>
      );
    }
    ```
  </TabItem>
  <TabItem value="query-key" label={<span style={{verticalAlign: 'middle'}}>by <code>QueryKey</code></span>}>
    Using the Query Key (array) as an arguments for the `useQuery` is useful
    with combination of [`api.<service>.<operation>.getQueryKey(...)`](/query-client/getQueryKey.mdx) method
    when shared Query Key is needed.

    ```tsx title="src/ApprovalPolicyName.tsx"
    import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

    import { requestFn } from '@openapi-qraft/react';
    import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

    const queryClient = new QueryClient();

    const api = createAPIClient({
      requestFn,
      queryClient,
      baseUrl: 'https://api.sandbox.monite.com/v1',
    });

    function ApprovalPolicyName() {
      /**
       * `<service>.<operation>.useQuery(...)` initiates the request to retrieve data:
       * ###
       * GET /approval_policies/123?items_order=asc&items_order=desc
       * x-monite-version: 2.0.0
       */
      const { data, error, isPending } =
        api.approvalPolicies.getApprovalPoliciesId.useQuery(
          [
            {
              method: "get",
              url: "/approval_policies/{approval_policy_id}",
            },
            {
              header: {
                "x-monite-version": "2.0.0",
              },
              path: {
                approval_policy_id: "321",
              },
              query: {
                items_order: ["asc", "desc"],
              },
            },
          ],
        );


      if (isPending) {
        return <div>Loading...</div>;
      }

      if (error) {
        return <div>Error: {error.message}</div>;
      }

      return <div>Approval Policy: {data?.name}</div>;
    }

    export default function App() {
      return (
        <QueryClientProvider client={queryClient}>
          <ApprovalPolicyName />
        </QueryClientProvider>
      );
    }
    ```
  </TabItem>
</Tabs>

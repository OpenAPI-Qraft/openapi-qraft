---
sidebar_position: 2
sidebar_label: useQuery
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# useQuery(...)

The Hook enables you to perform asynchronous data fetching operations.
It automatically handles loading states, caching, and data invalidation,
significantly simplifying request in React.
See the TanStack [_useQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQuery)
documentation for more details.

```ts
const query = qraft.<service>.<operation>.useQuery(
  parameters,
  queryOptions,
  queryClient,
)
```

### Arguments

1. `parameters: { path, query, header } | QueryKey | {}`
   - **Required**, OpenAPI request parameters for the query, strictly-typed âœ¨
   - `parameters` will be used to generate the `QueryKey`
   - Instead of an object with `{path, query, header}`, you can pass a `QueryKey` as an array
     which is also strictly-typed âœ¨
   - If operation does not require parameters, you must pass an empty object `{}` for strictness

2. `queryOptions?: UseQueryOptions`
   - **Optional**, represents the options of the [_useQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQuery) Hook
     - `queryOptions.queryFn` could be provided to override the default `queryFn` used by Qraft
     - ~~`queryOptions.queryKey`~~ is not allowed, as it will be generated from `parameters`

3. `queryClient?: QueryClient`
   - **Optional** [_QueryClient ðŸŒ´_](https://tanstack.com/query/latest/docs/reference/QueryClient) to be used
   - _If not provided_
     - `QraftContext.queryClient` will be used if available
     - [_useQueryClient() ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useQueryClient)
       result will be used as a fallback

### Example

<Tabs>
  <TabItem value="parameters" label={<span style={{verticalAlign: 'middle'}}>by <code>parameters</code></span>} default>
    ```tsx title="src/ApprovalPolicyName.tsx"
    import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

    const qraft = createAPIClient();

    function ApprovalPolicyName() {
      /**
       * `<service>.<operation>.useQuery(...)` will execute the request:
       * ###
       * GET /approval_policies/321?items_order=asc&items_order=desc
       * x-monite-version: 1.0.0
       */
      const { data, error, isPending } =
        qraft.approvalPolicies.getApprovalPoliciesId.useQuery(
          {
            header: {
              "x-monite-version": "1.0.0",
            },
            path: {
              approval_policy_id: "123",
            },
            query: {
              items_order: ["asc", "desc"],
            },
          },
        );

      if (isPending) {
        return <div>Loading...</div>;
      }

      if (error) {
        return <div>Error: {error.message}</div>;
      }

      return <div>Approval Policy: {data?.name}</div>;
    }
    ```
  </TabItem>
  <TabItem value="query-key" label={<span style={{verticalAlign: 'middle'}}>by <code>QueryKey</code></span>}>
    ```tsx title="src/ApprovalPolicyName.tsx"
    import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

    const qraft = createAPIClient();

    function ApprovalPolicyName() {
      /**
       * `<service>.<operation>.useQuery(...)` will execute the request:
       * ###
       * GET /approval_policies/123?items_order=asc&items_order=desc
       * x-monite-version: 2.0.0
       */
      const { data, error, isPending } =
        qraft.approvalPolicies.getApprovalPoliciesId.useQuery(
          [
            {
              method: "get",
              url: "/approval_policies/{approval_policy_id}",
            },
            {
              header: {
                "x-monite-version": "2.0.0",
              },
              path: {
                approval_policy_id: "321",
              },
              query: {
                items_order: ["asc", "desc"],
              },
            },
          ],
        );


      if (isPending) {
        return <div>Loading...</div>;
      }

      if (error) {
        return <div>Error: {error.message}</div>;
      }

      return <div>Approval Policy: {data?.name}</div>;
    }
    ```
  </TabItem>
</Tabs>

---
sidebar_label: useSuspenseInfiniteQuery()
---

# useSuspenseInfiniteQuery(...)

The Hook enables you to perform asynchronous data fetching operations with support for infinite scrolling scenarios.
The functionality is similar to the [_useInfiniteQuery_](/hooks/useInfiniteQuery.mdx) hook, but with the added benefit
of Suspense support.
For more detailed information, explore [_useSuspenseInfiniteQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useSuspenseInfiniteQuery) documentation for more details.

```ts
const query = api.<service>.<operation>.useSuspenseInfiniteQuery(
  parameters,
  suspenseInfiniteQueryOptions
)
```

### Arguments

1. `parameters: { path, query, header } | QueryKey | {}`
   - **Required** and strictly-typed âœ¨ parameters for the query
   - `parameters` will be used to generate the `QueryKey`
   - Instead of an object with `{path, query, header}`, you can pass a `QueryKey` as an array
     which is also strictly-typed âœ¨
   - If operation does not require parameters, you must pass an empty object `{}` for strictness

2. `suspenseInfiniteQueryOptions?: UseSuspenseInfiniteQueryOptions`
   - **Optional**, represents the options of the
     [_useSuspenseInfiniteQuery(...) ðŸŒ´_](https://tanstack.com/query/latest/docs/framework/react/reference/useSuspenseInfiniteQuery)
     Hook
     - `queryOptions.queryFn` could be provided to override the default `queryFn` used by Qraft
     - ~~`queryOptions.queryKey`~~ is not allowed, as it will be generated from `parameters`

### Examples

```tsx title="src/PostList.tsx"
import { Suspense } from 'react';
import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

import { requestFn } from '@openapi-qraft/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

const queryClient = new QueryClient();

const api = createAPIClient({
  requestFn,
  queryClient,
  baseUrl: 'https://api.sandbox.monite.com/v1',
});

function PostList() {
  /**
   * `api.posts.getPosts.useSuspenseInfiniteQuery(...)` launches the initial fetch operation:
   * ###
   * GET /posts?limit=10&page=1
   */
  const infiniteQuery = api.posts.getPosts.useSuspenseInfiniteQuery(
    { query: { limit: 10 } },
    {
      getNextPageParam: (lastPage, allPages, lastPageParams) => {
        if (lastPage.length < 10) return; // if less than 10 items, there are no more pages
        return {
          query: {
            page: Number(lastPageParams.query?.page) + 1,
          },
        };
      },
      initialPageParam: {
        query: {
          page: 1, // will be used in initial request
        },
      },
    }
  );

  return (
    <div>
      {infiniteQuery.data.pages.map((page, pageIndex) => (
        <ul key={pageIndex}>
          {page.map((post) => (
            <li key={post.id}>{post.title}</li>
          ))}
        </ul>
      ))}
      <button onClick={() => {
        // â¬‡ï¸Ž Initiates a GET request: GET /posts?limit=10&page=2
        infiniteQuery.fetchNextPage()
      }}>
        Load More
      </button>
    </div>
  );
}

export default function() {
  return (
    <QueryClientProvider client={queryClient}>
      <Suspense fallback={<div>Loading...</div>}>
        <PostList />
      </Suspense>
    </QueryClientProvider>
  );
}
```
